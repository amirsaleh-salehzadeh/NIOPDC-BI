<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- 
    Mapping file autogenerated by MyEclipse Persistence Tools
-->
<hibernate-mapping>
    <class name="aip.common.security.user.UserAllRoleENT" table="scuserallrole" dynamic-insert="true" dynamic-update="true">
        <id name="id" type="java.lang.Integer">
            <column name="ID" />
            <generator class="identity"/>
        </id>
        <property name="roleName" type="java.lang.String">
            <column name="RoleName"/>
        </property>
        <property name="userName" type="java.lang.String">
            <column name="UserName"/>
        </property>
    </class> 
	<sql-query name="sqlUserAllRoleQuery">
	    <return class="aip.common.security.group.RoleDTO"></return>
			SELECT r.ID,
			       r.RoleName ,
			       r.FarsiName
			FROM scuser u
			INNER JOIN scuserrole ur ON ur.UserName=u.UserName
			INNER JOIN scrole r ON r.ID = ur.F_SCRoleID
			WHERE u.UserName=:userName
			UNION DISTINCT
			SELECT r.ID,
			        r.RoleName ,
			        r.FarsiName
			 FROM scuser u  
			 INNER JOIN scusergroup ug ON ug.UserName=u.UserName
			 INNER JOIN scgrouprole gr ON gr.F_SCGroupID=ug.F_SCGroupID
			 INNER JOIN scrole r ON r.ID = gr.F_SCRoleID
			 WHERE u.UserName=:userName
	</sql-query>
   	<sql-query name="sqlGroupUsers">
	    <return class="aip.common.security.user.UserENT"></return>
		select u.*
		from scusergroup ug
<!--		INNER JOIN scuser u on ug.F_SCUserID=u.ID-->
		INNER JOIN scuser u on ug.UserName=u.UserName
		where ug.F_SCGroupID=:groupId
	</sql-query>
</hibernate-mapping>
